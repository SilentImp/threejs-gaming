THREE.Stats=function(){var t=Date.now(),e=t,i=0,s=1/0,o=0,n=0,a=1/0,h=0,r=0,c=0,l=document.createElement("div");l.id="stats",l.addEventListener("mousedown",function(t){t.preventDefault(),w(++c%2)},!1),l.style.cssText="width:80px;opacity:0.9;cursor:pointer";var d=document.createElement("div");d.id="fps",d.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",l.appendChild(d);var m=document.createElement("div");m.id="fpsText",m.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",m.innerHTML="FPS",d.appendChild(m);var u=document.createElement("div");for(u.id="fpsGraph",u.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",d.appendChild(u);74>u.children.length;){var p=document.createElement("span");p.style.cssText="width:1px;height:30px;float:left;background-color:#113",u.appendChild(p)}var v=document.createElement("div");v.id="ms",v.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",l.appendChild(v);var f=document.createElement("div");f.id="msText",f.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",f.innerHTML="MS",v.appendChild(f);var E=document.createElement("div");for(E.id="msGraph",E.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",v.appendChild(E);74>E.children.length;)p=document.createElement("span"),p.style.cssText="width:1px;height:30px;float:left;background-color:#131",E.appendChild(p);var w=function(t){switch(c=t){case 0:d.style.display="block",v.style.display="none";break;case 1:d.style.display="none",v.style.display="block"}};return{REVISION:11,domElement:l,setMode:w,begin:function(){t=Date.now()},end:function(){var c=Date.now();i=c-t,s=Math.min(s,i),o=Math.max(o,i),f.textContent=i+" MS ("+s+"-"+o+")";var l=Math.min(30,30-30*(i/200));return E.appendChild(E.firstChild).style.height=l+"px",r++,c>e+1e3&&(n=Math.round(1e3*r/(c-e)),a=Math.min(a,n),h=Math.max(h,n),m.textContent=n+" FPS ("+a+"-"+h+")",l=Math.min(30,30-30*(n/100)),u.appendChild(u.firstChild).style.height=l+"px",e=c,r=0),c},update:function(){t=this.end()}}},THREE.FirstPersonControls=function(t,e){function i(t,e){return function(){e.apply(t,arguments)}}this.object=t,this.target=new THREE.Vector3(0,0,0),this.domElement=void 0!==e?e:document,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.freeze=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0,this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(t){if(this.domElement!==document&&this.domElement.focus(),t.preventDefault(),t.stopPropagation(),this.activeLook)switch(t.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(t){if(t.preventDefault(),t.stopPropagation(),this.activeLook)switch(t.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(t){this.domElement===document?(this.mouseX=t.pageX-this.viewHalfX,this.mouseY=t.pageY-this.viewHalfY):(this.mouseX=t.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=t.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(t){switch(t.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0;break;case 81:this.freeze=!this.freeze}},this.onKeyUp=function(t){switch(t.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}},this.update=function(t){if(!this.freeze){if(this.heightSpeed){var e=THREE.Math.clamp(this.object.position.y,this.heightMin,this.heightMax),i=e-this.heightMin;this.autoSpeedFactor=t*i*this.heightCoef}else this.autoSpeedFactor=0;var s=t*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(s+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(s),this.moveLeft&&this.object.translateX(-s),this.moveRight&&this.object.translateX(s),this.moveUp&&this.object.translateY(s),this.moveDown&&this.object.translateY(-s);var o=t*this.lookSpeed;this.activeLook||(o=0);var n=1;this.constrainVertical&&(n=Math.PI/(this.verticalMax-this.verticalMin)),this.lon+=this.mouseX*o,this.lookVertical&&(this.lat-=this.mouseY*o*n),this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=THREE.Math.degToRad(90-this.lat),this.theta=THREE.Math.degToRad(this.lon),this.constrainVertical&&(this.phi=THREE.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));var a=this.target,h=this.object.position;a.x=h.x+100*Math.sin(this.phi)*Math.cos(this.theta),a.y=h.y+100*Math.cos(this.phi),a.z=h.z+100*Math.sin(this.phi)*Math.sin(this.theta),this.object.lookAt(a)}},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousemove",i(this,this.onMouseMove),!1),this.domElement.addEventListener("mousedown",i(this,this.onMouseDown),!1),this.domElement.addEventListener("mouseup",i(this,this.onMouseUp),!1),this.domElement.addEventListener("keydown",i(this,this.onKeyDown),!1),this.domElement.addEventListener("keyup",i(this,this.onKeyUp),!1),this.handleResize()},THREE.OrbitControls=function(t,e){function i(){return 2*Math.PI/60/60*c.autoRotateSpeed}function s(){return Math.pow(.95,c.userZoomSpeed)}function o(t){c.enabled!==!1&&c.userRotate!==!1&&(t.preventDefault(),0===t.button?(x=k.ROTATE,m.set(t.clientX,t.clientY)):1===t.button?(x=k.ZOOM,v.set(t.clientX,t.clientY)):2===t.button&&(x=k.PAN),document.addEventListener("mousemove",n,!1),document.addEventListener("mouseup",a,!1))}function n(t){if(c.enabled!==!1)if(t.preventDefault(),x===k.ROTATE)u.set(t.clientX,t.clientY),p.subVectors(u,m),c.rotateLeft(2*Math.PI*p.x/d*c.userRotateSpeed),c.rotateUp(2*Math.PI*p.y/d*c.userRotateSpeed),m.copy(u);else if(x===k.ZOOM)f.set(t.clientX,t.clientY),E.subVectors(f,v),E.y>0?c.zoomIn():c.zoomOut(),v.copy(f);else if(x===k.PAN){var e=t.movementX||t.mozMovementX||t.webkitMovementX||0,i=t.movementY||t.mozMovementY||t.webkitMovementY||0;c.pan(new THREE.Vector3(-e,i,0))}}function a(){c.enabled!==!1&&c.userRotate!==!1&&(document.removeEventListener("mousemove",n,!1),document.removeEventListener("mouseup",a,!1),x=k.NONE)}function h(t){if(c.enabled!==!1&&c.userZoom!==!1){var e=0;t.wheelDelta?e=t.wheelDelta:t.detail&&(e=-t.detail),e>0?c.zoomOut():c.zoomIn()}}function r(t){if(c.enabled!==!1&&c.userPan!==!1)switch(t.keyCode){case c.keys.UP:c.pan(new THREE.Vector3(0,1,0));break;case c.keys.BOTTOM:c.pan(new THREE.Vector3(0,-1,0));break;case c.keys.LEFT:c.pan(new THREE.Vector3(-1,0,0));break;case c.keys.RIGHT:c.pan(new THREE.Vector3(1,0,0))}}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.center=new THREE.Vector3,this.userZoom=!0,this.userZoomSpeed=1,this.userRotate=!0,this.userRotateSpeed=1,this.userPan=!0,this.userPanSpeed=2,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=1/0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var c=this,l=1e-6,d=1800,m=new THREE.Vector2,u=new THREE.Vector2,p=new THREE.Vector2,v=new THREE.Vector2,f=new THREE.Vector2,E=new THREE.Vector2,w=0,M=0,b=1,g=new THREE.Vector3,k={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},x=k.NONE,T={type:"change"};this.rotateLeft=function(t){void 0===t&&(t=i()),M-=t},this.rotateRight=function(t){void 0===t&&(t=i()),M+=t},this.rotateUp=function(t){void 0===t&&(t=i()),w-=t},this.rotateDown=function(t){void 0===t&&(t=i()),w+=t},this.zoomIn=function(t){void 0===t&&(t=s()),b/=t},this.zoomOut=function(t){void 0===t&&(t=s()),b*=t},this.pan=function(t){t.transformDirection(this.object.matrix),t.multiplyScalar(c.userPanSpeed),this.object.position.add(t),this.center.add(t)},this.update=function(){var t=this.object.position,e=t.clone().sub(this.center),s=Math.atan2(e.x,e.z),o=Math.atan2(Math.sqrt(e.x*e.x+e.z*e.z),e.y);this.autoRotate&&this.rotateLeft(i()),s+=M,o+=w,o=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,o)),o=Math.max(l,Math.min(Math.PI-l,o));var n=e.length()*b;n=Math.max(this.minDistance,Math.min(this.maxDistance,n)),e.x=n*Math.sin(o)*Math.sin(s),e.y=n*Math.cos(o),e.z=n*Math.sin(o)*Math.cos(s),t.copy(this.center).add(e),this.object.lookAt(this.center),M=0,w=0,b=1,g.distanceTo(this.object.position)>0&&(this.dispatchEvent(T),g.copy(this.object.position))},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("mousewheel",h,!1),this.domElement.addEventListener("DOMMouseScroll",h,!1),this.domElement.addEventListener("keydown",r,!1)},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.Bootstrap.registerPlugin("stats",{listen:["pre","post"],install:function(t){var e=this.stats=new THREE.Stats,i=e.domElement.style;i.position="absolute",i.top=i.left=0,document.body.appendChild(e.domElement),t.stats=e},uninstall:function(t){document.body.removeChild(this.stats.domElement),delete t.stats},pre:function(){this.stats.begin()},post:function(){this.stats.end()}}),THREE.Bootstrap.registerPlugin("controls",{listen:["update","resize","camera","this.change"],defaults:{klass:null,parameters:{}},install:function(t){if(!this.options.klass)throw"Must provide class for `controls.klass`";t.controls=null,this._camera=t.camera||new THREE.PerspectiveCamera,this.change(null,t)},uninstall:function(t){delete t.controls},change:function(t,e){this.options.klass?((!t||t.changes.klass)&&(e.controls=new this.options.klass(this._camera,e.renderer.domElement)),_.extend(e.controls,this.options.parameters)):e.controls=null},update:function(t,e){var i=e.Time&&e.Time.delta||1/60;e.controls.update(i)},camera:function(t,e){e.controls.object=this._camera=t.camera},resize:function(t,e){e.controls.handleResize&&e.controls.handleResize()}});